---
output:
  github_document:
    df_print: paged
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# tidygedcom

<!-- badges: start -->
<!-- badges: end -->

Import, create, and summarise family tree GEDCOM files using tidy dataframes. This package is still in heavy development with the first operational version unlikely to be complete before January 2021.

## Installation

You can install development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("jl5000/tidygedcom")
```

## Example

The intent is to allow the user to import GEDCOM files or create them from scratch using a `ggplot2` type interface; starting with a base GEDCOM object (with only a header and trailer section) and adding records as you would add layers to a ggplot object (but instead using the pipe operator, %>%).

An example is below:

```{r example}
library(tidygedcom)

tg <- gedcom(subm("Jamie Lendrum")) %>%
  add_individual(sex = "M", individual_notes = "The central character in the Star Wars Skywalker Saga") %>%
  add_individual_names("Anakin Skywalker", type = "birth", given = "Anakin", surname = "Skywalker") %>% 
  add_individual_event_death(age_at_event = "45y", event_cause = "Killed by son Luke",
                       place_name = "Second Death Star", place_notes = "Orbiting Endor System") %>% 
  add_individual_attribute_religion(attribute_descriptor = "Jedi") %>% 
  add_individual_attribute_possessions(attribute_descriptor = "Lightsaber") %>%
  add_individual(sex = "F", individual_notes = "Queen of Naboo") %>%
  add_individual_names("Padme Amidala") %>% 
  add_individual(sex = "F") %>% 
  add_individual_names("Leia Organa") %>% 
  add_individual(sex = "M") %>%
  add_individual_names("Luke Skywalker") %>% 
  add_family_group(husband = "Anakin", wife = "Padme", children = c("Luke", "Leia")) %>%
  add_individual(sex = "M") %>% 
  add_individual_names("Obi-Wan Kenobi") %>% 
  activate_individual_record("Anakin") %>% 
  add_individual_association("Obi-Wan", association = "Master") %>% 
  add_note("Based on Star Wars") %>% 
  add_source(short_title = "Star Wars", title = "Star Wars Episode IV: A New Hope") %>% 
  add_repository("The Skywalker Saga") %>% 
  add_multimedia(file_reference = "XYZ", format = "JPG")

tg
```


Just like a ggplot object requires aesthetics, a GEDCOM file requires details of a submitter. If no submitter details are given, the username is used.

Within the package, GEDCOM files are represented as tidy tibbles (a sub-class of tibble known as `tidygedcom` objects) allowing easy manipulation and exploitation of existing `tidyverse` infrastructure.

A number of functions are available to provide summaries of `tidygedcom` objects:

```{r}
num_indi(tg)
num_fam(tg)

str(tg)
summary(tg)

df_individuals(tg)
df_families(tg)
```

This package allows limited editing of `tidygedcom` objects (adding/removing records, as well as the addition of some record substructures). Editing of existing records is made possible through 'activation' (much like the `tidygraph` package). When a record is created, it automatically becomes the active record, through an object attribute. Record editing functions then act on this record. Other records can be activated through a series of `activate_*_record()` functions.

Two sister packages are planned:

* `shinygedcom` will provide a shiny app to edit `tidygedcom` objects;
* `visgedcom` will allow visualisation of `tidygedcom` objects.

## Current status

* The GEDCOM 5.5.5 specification has been implemented. This is the bulk of the internal data structures required (params.R, structures.R, records.R, and validate_params.R);
* Some initial functions to summarise tidygedcom objects have been completed (interrogate.R);
* Functions to import, export and create tidygedcom objects have been completed (import_export_create.R);
* Current work is on updating code for GEDCOM 5.5.5 and the modification of tidygedcom objects;
* Some simple validation checks have been written (validate_gedcom.R), but there won't be an extensive functionality for this given the number of GEDCOM validators available ([such as this one](http://ged-inline.elasticbeanstalk.com/validate)).
* Work on `shinygedcom` and `visgedcom` will begin once an initial version of `tidygedcom` is complete.

## References

* [The GEDCOM 5.5.5 Specification](https://www.gedcom.org/gedcom.html)
