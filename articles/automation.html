<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Automation and shared events • tidyged</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Automation and shared events">
<meta property="og:description" content="tidyged">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidyged</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jl5000/tidyged/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="automation_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Automation and shared events</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jl5000/tidyged/blob/master/vignettes/automation.Rmd"><code>vignettes/automation.Rmd</code></a></small>
      <div class="hidden name"><code>automation.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>In <code><a href="../articles/cross_references.html">vignette("cross_references")</a></code>, the concept of record activation was introduced, using either record xrefs or other attributes of the record. In this vignette, we show how this same functionality is used to ease and automate the generation of new records. We begin by using the same example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://jl5000.github.io/tidyged/">tidyged</a></span><span class="op">)</span>

<span class="va">simpsons</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gedcom.html">gedcom</a></span><span class="op">(</span><span class="fu"><a href="../reference/subm.html">subm</a></span><span class="op">(</span><span class="st">"Me"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/add_indi.html">add_indi</a></span><span class="op">(</span>qn <span class="op">=</span> <span class="st">"Homer Simpson"</span>, sex <span class="op">=</span> <span class="st">"M"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/add_indi.html">add_indi</a></span><span class="op">(</span>qn <span class="op">=</span> <span class="st">"Marge Simpson"</span>, sex <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/add_indi.html">add_indi</a></span><span class="op">(</span>qn <span class="op">=</span> <span class="st">"Lisa Simpson"</span>, sex <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/add_indi.html">add_indi</a></span><span class="op">(</span>qn <span class="op">=</span> <span class="st">"Bart Simpson"</span>, sex <span class="op">=</span> <span class="st">"M"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/add_note.html">add_note</a></span><span class="op">(</span><span class="st">"These records have not yet been joined in a family group record"</span><span class="op">)</span></code></pre></div>
<p>In some records it is necessary to provide xrefs to link to other records, for example the Family Group record requires xrefs of the husband, wife, and/or children. It can be tedious to have to manually look up these xrefs, and so <code>tidyged</code> allows the user to instead enter an expression uniquely identifying these records, just like activation:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simpsons</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/add_famg.html">add_famg</a></span><span class="op">(</span>husband <span class="op">=</span> <span class="st">"Homer"</span>, wife <span class="op">=</span> <span class="st">"Marge"</span>, children <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bart"</span>, <span class="st">"Lisa"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">record</span> <span class="op">==</span> <span class="st">"@F1@"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">level</th>
<th align="left">record</th>
<th align="left">tag</th>
<th align="left">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="left">
<span class="citation">@F1</span>@</td>
<td align="left">FAM</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">
<span class="citation">@F1</span>@</td>
<td align="left">HUSB</td>
<td align="left">
<span class="citation">@I1</span>@</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">
<span class="citation">@F1</span>@</td>
<td align="left">WIFE</td>
<td align="left">
<span class="citation">@I2</span>@</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">
<span class="citation">@F1</span>@</td>
<td align="left">CHIL</td>
<td align="left">
<span class="citation">@I4</span>@</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">
<span class="citation">@F1</span>@</td>
<td align="left">CHIL</td>
<td align="left">
<span class="citation">@I3</span>@</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">
<span class="citation">@F1</span>@</td>
<td align="left">CHAN</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">
<span class="citation">@F1</span>@</td>
<td align="left">DATE</td>
<td align="left">23 MAR 2021</td>
</tr>
</tbody>
</table>
<p>Note that the full name does not need to be given, since the expression is treated as a regular expression. As long as it is detected in the name of the individual it will be found (romanised and phonetic variants of the name are also searched, if they are provided in the record). Note that if forward-slashes are in the name, they should not be used in any expressions.</p>
<p>If no match or more than one match is found, it will result in an error:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simpsons</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/add_famg.html">add_famg</a></span><span class="op">(</span>husband <span class="op">=</span> <span class="st">"Simpson"</span>, wife <span class="op">=</span> <span class="st">"Marge"</span>, children <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bart"</span>, <span class="st">"Lisa"</span><span class="op">)</span><span class="op">)</span> 
<span class="co">#&gt; Error in find_xref(gedcom, xrefs_indi(gedcom), c("NAME", "ROMN", "FONE"), : More than one record found for the given regex: Homer Simpson, Marge Simpson, Lisa Simpson, Bart Simpson. </span>
<span class="co">#&gt; Try being more specific or supplying the xref explicitly.</span></code></pre></div>
</div>
<div id="family-links" class="section level2">
<h2 class="hasAnchor">
<a href="#family-links" class="anchor"></a>Family links</h2>
<p>The <code>tidyged</code> package seeks to make cross-referencing as painless and automated as possible. When adding a Family Group record, as well as creating the record, it will also create the relevant links to the family group in the Individual record for each member of the family:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simpsons_fam</span> <span class="op">&lt;-</span> <span class="va">simpsons</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/add_famg.html">add_famg</a></span><span class="op">(</span>husband <span class="op">=</span> <span class="st">"Homer"</span>, wife <span class="op">=</span> <span class="st">"Marge"</span>, children <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bart"</span>, <span class="st">"Lisa"</span><span class="op">)</span><span class="op">)</span> 

<span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">simpsons_fam</span>, <span class="va">tag</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FAMS"</span>, <span class="st">"FAMC"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">level</th>
<th align="left">record</th>
<th align="left">tag</th>
<th align="left">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">
<span class="citation">@I1</span>@</td>
<td align="left">FAMS</td>
<td align="left">
<span class="citation">@F1</span>@</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">
<span class="citation">@I2</span>@</td>
<td align="left">FAMS</td>
<td align="left">
<span class="citation">@F1</span>@</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">
<span class="citation">@I3</span>@</td>
<td align="left">FAMC</td>
<td align="left">
<span class="citation">@F1</span>@</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">
<span class="citation">@I4</span>@</td>
<td align="left">FAMC</td>
<td align="left">
<span class="citation">@F1</span>@</td>
</tr>
</tbody>
</table>
<p>The lines above show particular lines in the Individual records where they are linked to the Family Group record either as a spouse (FAMS) or as a child (FAMC).</p>
<p>If the Family Group record is subsequently removed, then these links will also be removed:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simpsons_no_fam</span> <span class="op">&lt;-</span> <span class="va">simpsons_fam</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/remove_famg.html">remove_famg</a></span><span class="op">(</span><span class="op">)</span> 

<span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">simpsons_no_fam</span>, <span class="va">tag</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FAMS"</span>, <span class="st">"FAMC"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 0 x 4</span>
<span class="co">#&gt; # … with 4 variables: level &lt;dbl&gt;, record &lt;chr&gt;, tag &lt;chr&gt;, value &lt;chr&gt;</span>

<span class="fu">waldo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/waldo/man/compare.html">compare</a></span><span class="op">(</span><span class="va">simpsons</span>, <span class="va">simpsons_no_fam</span>, ignore_attr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; ✔ No differences</span></code></pre></div>
<p>Similarly, when removing an Individual record, all associations with the individual will be removed in other individual records.</p>
<p>When removing a Family Group record, the user also has the option of removing all trace of the individuals within the family group as well:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simpsons_no_fam_purge</span> <span class="op">&lt;-</span> <span class="va">simpsons_fam</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/remove_famg.html">remove_famg</a></span><span class="op">(</span>remove_individuals <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">simpsons_no_fam_purge</span><span class="op">)</span>
<span class="co">#&gt; GEDCOM version 5.5.5 (LINEAGE-LINKED)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Individuals:         0</span>
<span class="co">#&gt; Families:            0</span>
<span class="co">#&gt; Submitters:          1</span>
<span class="co">#&gt; Multimedia objects:  0</span>
<span class="co">#&gt; Notes:               1</span>
<span class="co">#&gt; Sources:             0</span>
<span class="co">#&gt; Repositories:        0</span></code></pre></div>
<p>Note that as well as having no families defined, we also now have no individuals.</p>
<p style="text-align: right;">
<a href="https://jl5000.github.io/tidyged/articles/relations.html">Next article: Identifying relations &gt;</a>
</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jamie Lendrum.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
