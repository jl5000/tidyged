---
title: "Individual records"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Individual records}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(tidyged)
```

## Introduction

Adding individuals to a tidyged object can be achieved with the `add_indi()` function. The sex of the individual can be specified with the `sex` parameter, which is a single letter: M(ale), F(emale), (Interse)X, U(nknown), N(ot recorded). If no sex is specified, a value of "U" is used.

As with other records, various types of user-defined references can be defined (`user_reference_number` and `user_reference_type`), as well as links to multimedia and notes.

## Individual names

Individuals can be given more than one name. These can be different kinds of name such as birth name or adoptive name, or if there is uncertainty, variants of these based on conflicting evidence sources. There is also the ability to provide phonetic and romanised variants of names. Given this complexity, the name is usually not immediately defined when creating an Individual record.

### Adding individual names

The main function for providing names for an individual is `add_indi_names()`:

```{r}
gedcom(subm("Me")) %>% 
  add_indi() %>% 
  add_indi_names(given = "Leia", surname = "Skywalker") %>% 
  dplyr::filter(record == "@I1@") %>% 
  knitr::kable()
```

In the GEDCOM specification, all names should be provided by a set of name pieces, specifying the given name, surname, nickname, etc. The function will then automatically construct a formatted full name from this information (surrounding surnames with forward slashes - as given in the specification). 

A shortcut way of defining a name is to use the `qn` (quick name) parameter when defining an individual. It's not ideal, and should really only be reserved for demonstrations (like this one)! The function will crudely place the entire string as the given name of the individual:

```{r}
gedcom(subm("Me")) %>% 
  add_indi(qn = "Leia Skywalker") %>% 
  dplyr::filter(record == "@I1@") %>% 
  knitr::kable()
```

### Phonetic and romanised names

Once we have defined a name for an individual, we can also define phonetic and romanised versions of the name. For this, we use the `add_indi_names_var()` function. As a minimum, the original name, variant name pieces, derivation method, and whether it is a phonetic or romanised variation should be given:

```{r}
gedcom(subm("Me")) %>% 
  add_indi() %>% 
  add_indi_names(given = "Leia", surname = "Skywalker", type = "birth") %>% 
  add_indi_names_var("Leia Skywalker", method = "As spoken",
                     given = "Laya", surname = "Skywalker", phonetic_variation = TRUE) %>% 
  dplyr::filter(record == "@I1@") %>% 
  knitr::kable()
```


### Name types

The `type` parameter can also define different names for the individual. Below we add a line to define an adoptive name (the parameter can take any value):

```{r}
gedcom(subm("Me")) %>% 
  add_indi() %>% 
  add_indi_names(given = "Leia", surname = "Skywalker", type = "birth") %>% 
  add_indi_names_var("Leia Skywalker", method = "As spoken", 
                     phonetic_variation = TRUE, given = "Laya", surname = "Skywalker") %>% 
  add_indi_names(given = "Leia", surname = "Organa", type = "adoptive") %>% 
  dplyr::filter(record == "@I1@") %>% 
  knitr::kable()
```

### Conflicting names

GEDCOM files can also record different names *of the same type*, perhaps due to conflicting evidence. Below we define a name of Leia Skywaker (with no l) indicating some kind of transcription error:

```{r}
gedcom(subm("Me")) %>% 
  add_indi() %>% 
  add_indi_names(given = "Leia", surname = "Skywalker", type = "birth") %>% 
  add_indi_names_var("Leia Skywalker", method = "As spoken", 
                     phonetic_variation = TRUE, given = "Laya", surname = "Skywalker") %>% 
  add_indi_names(given = "Leia", surname = "Organa", type = "adoptive") %>% 
  add_indi_names(given = "Leia", surname = "Skywaker", type = "birth") %>%
  dplyr::filter(record == "@I1@") %>% 
  knitr::kable()
```

Generally conflicting names are arranged in order of confidence; the first name is more likely to be correct. If you want to promote a name to occur first in the record, you can use the `primary_indi_name()` function:

```{r}
gedcom(subm("Me")) %>% 
  add_indi() %>% 
  add_indi_names(given = "Leia", surname = "Skywalker", type = "birth") %>% 
  add_indi_names_var("Leia Skywalker", method = "As spoken", 
                     phonetic_variation = TRUE, given = "Laya", surname = "Skywalker") %>% 
  add_indi_names(given = "Leia", surname = "Organa", type = "adoptive") %>% 
  add_indi_names(given = "Leia", surname = "Skywaker", type = "birth") %>%
  primary_indi_name("Leia Skywaker") %>% 
  dplyr::filter(record == "@I1@") %>% 
  knitr::kable()
```

Note that the subrecords of the Individual record (those at level 1) can appear in any order.

## Individual events


## Individual attributes

